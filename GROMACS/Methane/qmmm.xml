<options>
    <qmmm help="Executes qmmm calculations for individual molecules and clusters" section="sec:qmmm">
        <print_regions_pdb help="print the geometry of the regions to a pdb file">true</print_regions_pdb>
        <max_iterations help="max iterations for qmmm scf loop">50</max_iterations>
        <map_file help="xml file with segment definition">system.xml</map_file>
        <job_file help="name of jobfile to which jobs are written">qmmm_jobs.xml</job_file>
        <write_parse>
            <states help="states to write jobs for and which to parse from jobfile">n s1 t1</states>
        </write_parse>
        
        <regions  help="definition of regions in qmmm setup. First region can be a QM region. In each region all options can be also read from a jobfile by the keyword 'jobfile'">
            <region help="definition of a region">
                <id help="id of a region has to start from 0">0</id>
                <type help="type of region qm/static/polar">qm</type>
                <options_dft help="xml file with options for dft calculations">
                    <package>
                        <name help="name of dft package" default="xtp">xtp</name>
                    </package>
                </options_dft>

                <options_gwbse help="xml file with options for gwbse calculations">
                <gwbse>
                        <ranges help="default: all levels in RPA, 1:2*HOMO in QP and all in BSE; other options: factor,explicit">default</ranges>
	                <rpamax help="only needed, if ranges is factor or explicit, number of levels in rpa" default=""></rpamax>
	                <qpmin help="only needed, if ranges is factor or explicit, lowest MO to be used in GW" default="" ></qpmin>
	                <qpmax help="only needed, if ranges is factor or explicit, highest MO to be used in GW" default=""></qpmax>
	                <bsemin help="only needed, if ranges is factor or explicit, lowest MO to be used in BSE" default=""></bsemin>
	                <bsemax help="only needed, if ranges is factor or explicit, highest MO to be used in BSE" default=""></bsemax>
	                <vxc help="Exchange correlation functional computation for GW">
	                    <grid help="grid quality xcoarse,coarse,medium,fine,xfine" default="medium">medium</grid>
	                </vxc>
	                <scissor_shift help="preshift unoccupied MOs by a constant for GW calculation" default="0.0" unit="hartree">0.0</scissor_shift>
	                <mode help="use single short (G0W0) or self-consistent GW (evGW)" default="evGW">evGW</mode>
	                <tasks help="tasks to do gw,singlets,triplets or all" default="gw,singlets">gw,singlets</tasks>
	                <sigma_integrator help="self-energy correlation integration method: ppm, exact" default="ppm">ppm</sigma_integrator>
	                <eta help="small parameter eta of the Green's function" default="1e-3">1e-3</eta>
	                <qp_solver help="QP equation solve method: fixedpoint, grid" default="grid">grid</qp_solver>
	                <qp_grid_steps help="number of QP grid points" default="1001">1001</qp_grid_steps>
	                <qp_grid_spacing help="spacing of QP grid points in Ha" default="0.001">0.001</qp_grid_spacing>
	                <exctotal help="maximum number of BSE states to calculate" default="30">30</exctotal>
	                <useTDA help="use TDA for BSE default `false`" default="0">0</useTDA>
	                <ignore_corelevels help="exclude core MO level from calculation on RPA,GW or BSE level" default="no">no</ignore_corelevels>
	                <eigensolver help="options for BSE eigenvalue decompostion">
	                    <dodavidson help="use davidson solver" default="1">1</dodavidson>
	                    <davidson_correction help="DPR or OHLSEN" default="DPR">DPR</davidson_correction>
                        <davidson_tolerance help="loose,normal,strict" default="strict">strict</davidson_tolerance>
	                    <davidson_ortho help="orthogonalisation routine GS or QR" default="GS">GS</davidson_ortho>
	                    <davidson_update help=" how large the search space can become min, safe, max" default="safe">safe</davidson_update>
	                    <davidson_maxiter help="max iterations" default="50">50</davidson_maxiter>
	                    <domatrixfree help="solve without explicitly setting up BSE matrix, (slower but a lot less memory required" default="0">0</domatrixfree>
	                </eigensolver>
	                <gw_sc_max_iterations help="Maximum number of iterations in gvGW" default="50">50</gw_sc_max_iterations>
	                <gw_mixing_order help="Mixing of QP energies in evGW - 0: plain, 1: linear, >1: Anderson" default="20">20</gw_mixing_order>
	                <g_sc_max_iterations help="What is this again?" default="100">100</g_sc_max_iterations>
	                <use_Hqp_offdiagonals help="Using symmetrized off-diagonal elements of QP Hamiltonian in BSE" default="false">false</use_Hqp_offdiagonals>
                </gwbse>       	    
                </options_gwbse>

                <statetracker help="filter to identify excited states from some characteristic and not the energy">
                    <oscillator_strength>0.5</oscillator_strength>
                </statetracker>
                <state help="qmstate to calculate i.e. n or s1">jobfile</state>
                <segments help="which segments to include in this region and which geometry they have">jobfile</segments>
            </region>
            <region>
                <id>1</id>
                <type>polar</type>
                <options_polar help="xml file with options for classical polarized calculations">
                    <tolerance_energy help="Energy change as convergence criterion" default="1e-5">1e-5</tolerance_energy>
                    <tolerance_dipole help="Field change as convergence criterion" default="1e-5">1e-5</tolerance_dipole>
                    <max_iter help="Maximum number of iterations" default="51">512</max_iter>
                    <exp_damp help="Thole sharpness parameter" default="0.39">0.39</exp_damp>
                </options_polar>
                <cutoff help="cutoff to define segments via distance to some segment in the same region or another region">
                    <relative_to_explicit_segs help="if distance should only be calculated to explicitly stated segments in the region or all which are also in the cutoff">true</relative_to_explicit_segs>
                    <geometry help="geometry that should be used for these segments">n</geometry>
                    <radius help="maximum distance to reference to be in region" unit="nm">1</radius>
                    <region help="region to calculate distance to. Delete if you want to calculate distance to segments in this region" >0</region>
                </cutoff>
            </region>
            <region>
                <id>2</id>
                <type>static</type>
                <cutoff>
                    <relative_to_explicit_segs>true</relative_to_explicit_segs>
                    <geometry>n</geometry>
                    <radius>1.4</radius>
                    <region>0</region>
                </cutoff>
            </region>
        </regions>
    </qmmm>

</options>
